<!-- https://gohugo.io/content-management/menus/ -->
{{ $page := . }}
{{ $menus := .Site.Menus.document }}

<div class="menu">
  {{ range (where $menus "HasChildren" false) }}
    {{ $active := "" }}
    {{ if $page.IsMenuCurrent "document" . }}
      {{ $active = "active"}}
    {{ end }}

    <a href="{{ .URL }}" class="{{ $active }}">{{- .Name -}} </a>
  {{ end }}

  {{ range (where $menus "HasChildren" true) }}
    <div class="category">
      <p>{{- .Name -}}</p>

      {{ range .Children }}
        {{ if not .HasChildren }}
          {{ $active := "" }}
          {{ if $page.IsMenuCurrent "document" . }}
            {{ $active = "active"}}
          {{ end }}

          <a class="item {{ $active }}" href="{{ .URL }}">{{- .Name -}}</a>
        {{ else }}
          <div class="sub-category">
            {{ $isExpaned := false }}
            {{ if $page.HasMenuCurrent "document" . }}
              {{ $isExpaned = true }}
            {{ end }}

            {{ $collapseTarget := printf "%s-collapse" .KeyName }}
            <a class="title" href="#"
              data-toggle="collapse" data-target="#{{ $collapseTarget }}" aria-expanded="{{ $isExpaned }}"
            >
              {{ .Name -}}
            </a>

            <div id="{{ $collapseTarget }}" class="{{ if $isExpaned }} show {{ else }} hide {{ end }}">
              {{ range .Children }}
                {{ $active := "" }}
                {{ if $page.IsMenuCurrent "document" . }}
                  {{ $active = "active"}}
                {{ end }}

                <a class="item {{ $active }}" href="{{ .URL }}" class="{{ $active }}">{{- .Name -}}</a>
              {{ end }}
          </div>
          </div>
        {{ end }}
      {{ end }}
    </div>
  {{ end }}
</div>
